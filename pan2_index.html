<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ‘ãƒ³å±‹çµŒå–¶ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ Pro</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --primary: #5d4037; --accent: #ff9800; --bg: #fafafa; }
        body { font-family: "Helvetica Neue", Arial, sans-serif; background: var(--bg); color: #333; padding: 20px; line-height: 1.6; }
        .container { max-width: 1000px; margin: auto; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: var(--primary); border-bottom: 3px solid var(--accent); padding-bottom: 10px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; margin-top: 20px; }
        .section { padding: 20px; border: 1px solid #eee; border-radius: 10px; background: #fff; }
        h2 { font-size: 1.1rem; color: var(--primary); margin-top: 0; display: flex; align-items: center; }
        label { display: block; font-size: 0.85rem; margin: 10px 0 5px; font-weight: bold; color: #666; }
        input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; font-size: 1rem; }
        .dashboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 25px 0; }
        .stat-card { background: var(--primary); color: white; padding: 20px; border-radius: 10px; text-align: center; }
        .stat-card.accent { background: var(--accent); }
        .stat-value { font-size: 1.5rem; font-weight: bold; display: block; margin-top: 5px; }
        .stat-label { font-size: 0.8rem; opacity: 0.9; }
        .chart-container { position: relative; height: 300px; width: 100%; margin-top: 30px; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ ãƒ‘ãƒ³å±‹çµŒå–¶åˆ†æã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>

    <div class="grid">
        <div class="section">
            <h2>ğŸ’° å›ºå®šè²» & æ¸›ä¾¡å„Ÿå´</h2>
            <label>æœˆé–“çµŒè²»(å®¶è³ƒãƒ»å…‰ç†±ãƒ»æ¶ˆè€—å“)</label>
            <input type="number" id="fixed_rent" value="550000">
            <label>æœˆé–“äººä»¶è²»(æ­£ç¤¾å“¡ãƒ»ã‚¢ãƒ«ãƒã‚¤ãƒˆ)</label>
            <input type="number" id="fixed_labor" value="950000">
            <label>æœˆé–“åºƒå‘Šè²»ãƒ»ãã®ä»–</label>
            <input type="number" id="fixed_other" value="360000">
            <label>æœ‰å½¢å›ºå®šè³‡ç”£ï¼ˆå†…è£…ãƒ»å¨æˆ¿ç­‰ï¼‰</label>
            <input type="number" id="asset_val" value="15000000">
            <label>è€ç”¨å¹´æ•°ï¼ˆå¹´ï¼‰</label>
            <input type="number" id="asset_years" value="10">
        </div>

        <div class="section" style="background: #fff8e1;">
            <h2>ğŸ“ˆ å¤‰å‹•è²» & å®¢æ•°ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h2>
            <label>å®¢å˜ä¾¡ (å††)</label>
            <input type="number" id="unit_price" value="960">
            <label>ææ–™åŸä¾¡ç‡ (%)</label>
            <input type="number" id="cost_rate" value="35">
            <label>åºƒå‘Šæ–™ç‡/æ±ºæ¸ˆæ‰‹æ•°æ–™ (%)</label>
            <input type="number" id="fee_rate" value="10">
            <label>1æ—¥ã®æƒ³å®šå®¢æ•° (äºº)</label>
            <input type="number" id="daily_customers" value="150">
            <label>æœˆé–“å–¶æ¥­æ—¥æ•° (æ—¥)</label>
            <input type="number" id="working_days" value="25">
        </div>
    </div>

    <div class="dashboard">
        <div class="stat-card">
            <span class="stat-label">æç›Šåˆ†å²ç‚¹å£²ä¸Š (æœˆ)</span>
            <span class="stat-value" id="bep_val">Â¥0</span>
        </div>
        <div class="stat-card accent">
            <span class="stat-label">äºˆæ¸¬æœˆé–“åˆ©ç›Š (ç¨å¼•å‰)</span>
            <span class="stat-value" id="profit_val">Â¥0</span>
        </div>
        <div class="stat-card">
            <span class="stat-label">1æ—¥ã‚ãŸã‚Šå¿…è¦å®¢æ•°</span>
            <span class="stat-value" id="needed_cust">0 äºº</span>
        </div>
    </div>

    <div class="chart-container">
        <canvas id="businessChart"></canvas>
    </div>
</div>

<script>
let myChart;
const inputs = document.querySelectorAll('input');
inputs.forEach(input => input.addEventListener('input', calculate));

function calculate() {
    // å€¤ã®å–å¾—
    const fixedRent = parseFloat(document.getElementById('fixed_rent').value) || 0;
    const fixedLabor = parseFloat(document.getElementById('fixed_labor').value) || 0;
    const fixedOther = parseFloat(document.getElementById('fixed_other').value) || 0;
    const assetVal = parseFloat(document.getElementById('asset_val').value) || 0;
    const assetYears = parseFloat(document.getElementById('asset_years').value) || 1;
    
    const unitPrice = parseFloat(document.getElementById('unit_price').value) || 0;
    const costRate = parseFloat(document.getElementById('cost_rate').value) / 100;
    const feeRate = parseFloat(document.getElementById('fee_rate').value) / 100;
    const dailyCust = parseFloat(document.getElementById('daily_customers').value) || 0;
    const workingDays = parseFloat(document.getElementById('working_days').value) || 0;

    // æ¸›ä¾¡å„Ÿå´è²» (æœˆé¡)
    const depreciation = assetVal / (assetYears * 12);
    
    // åˆè¨ˆå›ºå®šè²»
    const totalFixed = fixedRent + fixedLabor + fixedOther + depreciation;
    
    // é™ç•Œåˆ©ç›Šç‡
    const marginRate = 1 - (costRate + feeRate);
    
    // æç›Šåˆ†å²ç‚¹
    const bep = marginRate > 0 ? totalFixed / marginRate : 0;
    
    // äºˆæ¸¬å£²ä¸Šã¨åˆ©ç›Š
    const monthlySales = unitPrice * dailyCust * workingDays;
    const monthlyProfit = (monthlySales * marginRate) - totalFixed;
    
    // å¿…è¦å®¢æ•°
    const neededDailyCust = bep / unitPrice / workingDays;

    // è¡¨ç¤ºåæ˜ 
    document.getElementById('bep_val').innerText = "Â¥" + Math.round(bep).toLocaleString();
    document.getElementById('profit_val').innerText = "Â¥" + Math.round(monthlyProfit).toLocaleString();
    document.getElementById('needed_cust').innerText = Math.ceil(neededDailyCust) + " äºº";

    updateChart(totalFixed, marginRate, monthlySales, bep);
}

function updateChart(fixed, rate, sales, bep) {
    const ctx = document.getElementById('businessChart').getContext('2d');
    if (myChart) myChart.destroy();

    myChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: ['0', 'æç›Šåˆ†å²ç‚¹', 'äºˆæ¸¬å£²ä¸Š'],
            datasets: [
                {
                    label: 'å£²ä¸Šé«˜',
                    data: [0, bep, sales],
                    borderColor: '#ff9800',
                    backgroundColor: 'rgba(255, 152, 0, 0.1)',
                    fill: true
                },
                {
                    label: 'ç·è²»ç”¨',
                    data: [fixed, fixed + (bep * (1-rate)), fixed + (sales * (1-rate))],
                    borderColor: '#5d4037',
                    fill: false
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: { beginAtZero: true, ticks: { callback: value => 'Â¥' + value.toLocaleString() } }
            }
        }
    });
}

calculate();
</script>
</body>
</html>